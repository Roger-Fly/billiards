Index: xiaochengxu/app.wxss
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>/* å…¨å±€æ ·å¼ */\r\npage {\r\n  background-color: #f4f6f9;\r\n}\r\n\r\n.container {\r\n  max-width: 500px;\r\n  margin: auto;\r\n  padding: 20px;\r\n}\r\n\r\n.btn-add, .btn-start, .btn-end, .btn-reset {\r\n  margin-top: 10px;\r\n  padding: 10px 15px;\r\n  font-size: 16px;\r\n  border-radius: 6px;\r\n  width: 100%;\r\n}\r\n\r\n.btn-add {\r\n  background-color: #007bff;\r\n  color: white;\r\n}\r\n\r\n.btn-start {\r\n  background-color: #28a745;\r\n  color: white;\r\n}\r\n\r\n.btn-end {\r\n  background-color: #dc3545;\r\n  color: white;\r\n}\r\n\r\n.btn-reset {\r\n  background-color: #ffc107;\r\n  color: black;\r\n}\r\n\r\n.name {\r\n  font-weight: bold;\r\n}\r\n\r\n.status {\r\n  font-size: 12px;\r\n  color: green;\r\n  margin-left: 8px;\r\n}\r\n\r\n.balance {\r\n  font-weight: bold;\r\n  color: #dc3545;\r\n  font-size: 14px;\r\n  display: block;\r\n  margin-top: 6px;\r\n}\r\n\r\n.cost {\r\n  font-weight: bold;\r\n  min-width: 60px;\r\n  text-align: right;\r\n  font-size: 14px;\r\n  color: #28a745;\r\n  display: block;\r\n  margin-top: 4px;\r\n}\r\n\r\n.actions {\r\n  display: flex;\r\n  flex-wrap: wrap;\r\n  gap: 6px;\r\n  margin-top: 10px;\r\n}\r\n\r\n.actions button {\r\n  background: linear-gradient(145deg, #ffffff, #f0f0f0);\r\n  border: 1px solid #ddd;\r\n  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);\r\n  padding: 6px 10px;\r\n  font-size: 13px;\r\n  color: #333;\r\n  border-radius: 6px;\r\n  cursor: pointer;\r\n  transition: all 0.2s ease-in-out;\r\n  flex: 1 1 calc(50% - 3px);\r\n  max-width: calc(50% - 3px);\r\n  box-sizing: border-box;\r\n}\r\n\r\n.actions button:hover {\r\n  background: linear-gradient(145deg, #f8f8f8, #e9e9e9);\r\n  transform: translateY(-1px);\r\n  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);\r\n}\r\n\r\n.actions button:active {\r\n  transform: translateY(0);\r\n  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);\r\n}\r\n\r\n.undo-btn {\r\n  background: linear-gradient(145deg, #e34848, #d50909);\r\n  color: white;\r\n  border-color: #da3838;\r\n}\r\n\r\n.person {\r\n  background-color: #ffffff;\r\n  border-radius: 10px;\r\n  box-shadow: 0 2px 6px rgba(0, 0, 0, 0.08);\r\n  padding: 16px;\r\n  margin-bottom: 16px;\r\n  position: relative;\r\n}\r\n\r\n.avatar {\r\n  width: 40px;\r\n  height: 40px;\r\n  background-color: #2253a1;\r\n  color: white;\r\n  font-weight: bold;\r\n  font-size: 18px;\r\n  border-radius: 50%;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  flex-shrink: 0;\r\n}\r\n\r\n.log {\r\n  margin-top: 15px;\r\n  white-space: pre-wrap;\r\n  background-color: #f8f9fa;\r\n  padding: 10px;\r\n  border-radius: 6px;\r\n  height: 100px;\r\n  overflow-y: auto;\r\n  font-size: 12px;\r\n  color: #555;\r\n}\r\n\r\n.result {\r\n  margin-top: 15px;\r\n  font-size: 16px;\r\n  font-weight: bold;\r\n  text-align: center;\r\n  color: #333;\r\n}\r\n
===================================================================
diff --git a/xiaochengxu/app.wxss b/xiaochengxu/app.wxss
--- a/xiaochengxu/app.wxss	
+++ b/xiaochengxu/app.wxss	
@@ -47,7 +47,7 @@
   margin-left: 8px;
 }
 
-.balance {
+.point {
   font-weight: bold;
   color: #dc3545;
   font-size: 14px;
Index: xiaochengxu/pages/index/index.js
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>const formatDuration = require('../../utils/formatDuration');\r\n\r\nPage({\r\n  data: {\r\n    hourlyRate: 0,\r\n    waterFeeRate: 50,\r\n    waterFeeTarget: 50,\r\n    collectedWaterFee: 0,\r\n    endMode: 'manual',\r\n    endModeText: 'æ‰‹åŠ¨å…³å°',\r\n    endTime: '',\r\n    duration: '',\r\n    members: [],\r\n    isEnded: false,\r\n    btnStartDisabled: true,\r\n    btnEndDisabled: true,\r\n    logContent: '',\r\n    showInputModal: false,\r\n    inputName: '',\r\n    showGiveScoreModal: false,\r\n    fromMemberId: null,\r\n    fromMemberName: '',\r\n    targetNames: [],\r\n    selectedTargetIndex: 0,\r\n    selectedTargetName: '',\r\n    scoreAmount: '',\r\n    showHistoryModal: false,\r\n    historyMemberName: '',\r\n    historyText: '',\r\n    durationDisplay: '00:00:00',\r\n    totalCost: 0\r\n  },\r\n\r\n  onLoad() {\r\n    this.loadDataFromLocalStorage();\r\n    this.updateButtonStates();\r\n  },\r\n\r\n  onHourlyRateInput(e) {\r\n    const val = parseFloat(e.detail.value);\r\n    this.setData({ hourlyRate: isNaN(val) ? 0 : val });\r\n    this.saveDataToLocalStorage();\r\n  },\r\n  onWaterFeeRateInput(e) {\r\n    const val = parseFloat(e.detail.value);\r\n    this.setData({ waterFeeRate: isNaN(val) ? 0 : val });\r\n    this.saveDataToLocalStorage();\r\n  },\r\n  onWaterFeeTargetInput(e) {\r\n    const val = parseFloat(e.detail.value);\r\n    this.setData({ waterFeeTarget: isNaN(val) ? 0 : val });\r\n    this.saveDataToLocalStorage();\r\n  },\r\n  onEndTimeInput(e) {\r\n    this.setData({ endTime: e.detail.value });\r\n    this.saveDataToLocalStorage();\r\n  },\r\n  onDurationInput(e) {\r\n    this.setData({ duration: e.detail.value });\r\n    this.saveDataToLocalStorage();\r\n  },\r\n\r\n  toggleEndOptions(e) {\r\n    const idx = e.detail.value;\r\n    const modes = ['manual', 'time', 'duration'];\r\n    const texts = ['æ‰‹åŠ¨å…³å°', 'æŒ‡å®šæ—¶é—´å…³å°ï¼ˆå‹¿å…³ï¼‰', 'æ—¶é•¿å…³å°ï¼ˆå‹¿å…³ï¼‰'];\r\n    this.setData({\r\n      endMode: modes[idx],\r\n      endModeText: texts[idx]\r\n    });\r\n    this.saveDataToLocalStorage();\r\n  },\r\n\r\n  addPerson() {\r\n    this.setData({ showInputModal: true, inputName: '' });\r\n  },\r\n  onInputNameChange(e) {\r\n    this.setData({ inputName: e.detail.value });\r\n  },\r\n  confirmInput() {\r\n    const name = this.data.inputName.trim();\r\n    if (name) {\r\n      const id = Date.now() + Math.floor(Math.random() * 1000);\r\n      const member = {\r\n        id: id,\r\n        name: name,\r\n        joinTime: this.data.startTime ? new Date().getTime() : null,\r\n        totalTime: 0,\r\n        balance: 0,\r\n        finalBalance: 0,\r\n        active: this.data.startTime ? true : false,\r\n        history: [],\r\n        undoDisabled: false\r\n      };\r\n      this.data.members.push(member);\r\n      this.setData({ members: this.data.members });\r\n      this.log(`${member.name} åŠ å…¥`);\r\n    }\r\n    this.saveDataToLocalStorage();\r\n    this.setData({ showInputModal: false });\r\n  },\r\n  cancelInput() {\r\n    this.setData({ showInputModal: false });\r\n  },\r\n\r\n  leaveMember(e) {\r\n    const id = e.currentTarget.dataset.id;\r\n    const member = this.data.members.find(m => m.id === id);\r\n    if (!member || !member.active) return;\r\n\r\n    const now = new Date().getTime();\r\n    const duration = now - member.joinTime;\r\n    member.totalTime += duration;\r\n    member.joinTime = null;\r\n    member.active = false;\r\n    this.setData({ members: this.data.members });\r\n    this.log(`${member.name} é€€å‡ºæˆ¿é—´`);\r\n    this.saveDataToLocalStorage();\r\n  },\r\n  rejoinMember(e) {\r\n    const id = e.currentTarget.dataset.id;\r\n    const member = this.data.members.find(m => m.id === id);\r\n    if (!member || member.active) return;\r\n\r\n    member.joinTime = new Date().getTime();\r\n    member.active = true;\r\n    delete member.fixedCost;\r\n    this.setData({ members: this.data.members });\r\n    this.log(`${member.name} å†æ¬¡åŠ å…¥æˆ¿é—´`);\r\n    this.saveDataToLocalStorage();\r\n  },\r\n\r\n  openGiveScoreModal(e) {\r\n    const fromId = e.currentTarget.dataset.id;\r\n    const fromMember = this.data.members.find(m => m.id === fromId);\r\n    if (!fromMember) return;\r\n\r\n    const targets = this.data.members.filter(m => m.id !== fromId);\r\n    if (targets.length === 0) {\r\n      wx.showToast({ title: 'æ²¡æœ‰å…¶ä»–æˆå‘˜å¯ä»¥è½¬è´¦' });\r\n      return;\r\n    }\r\n\r\n    this.setData({\r\n      showGiveScoreModal: true,\r\n      fromMemberId: fromId,\r\n      fromMemberName: fromMember.name,\r\n      targetNames: targets.map(t => t.name),\r\n      selectedTargetIndex: 0,\r\n      selectedTargetName: targets[0].name,\r\n      scoreAmount: ''\r\n    });\r\n  },\r\n  onTargetSelectChange(e) {\r\n    const idx = e.detail.value;\r\n    const names = this.data.targetNames;\r\n    this.setData({\r\n      selectedTargetIndex: idx,\r\n      selectedTargetName: names[idx]\r\n    });\r\n  },\r\n  onScoreInputChange(e) {\r\n    this.setData({ scoreAmount: e.detail.value });\r\n  },\r\n  submitGiveScore() {\r\n    const amount = parseFloat(this.data.scoreAmount);\r\n    if (isNaN(amount) || amount <= 0) {\r\n      wx.showToast({ title: 'è¯·è¾“å…¥æœ‰æ•ˆé‡‘é¢' });\r\n      return;\r\n    }\r\n\r\n    const fromId = this.data.fromMemberId;\r\n    const fromMember = this.data.members.find(m => m.id === fromId);\r\n    const toName = this.data.selectedTargetName;\r\n    const toMember = this.data.members.find(m => m.name === toName);\r\n\r\n    if (!toMember) {\r\n      wx.showToast({ title: 'æœªæ‰¾åˆ°è¯¥æˆå‘˜' });\r\n      return;\r\n    }\r\n\r\n    const rate = this.data.waterFeeRate / 100;\r\n    const target = this.data.waterFeeTarget;\r\n    let fee = 0;\r\n    let actualAmount = amount;\r\n\r\n    if (this.data.collectedWaterFee < target) {\r\n      const remaining = target - this.data.collectedWaterFee;\r\n      const possibleFee = Math.abs(amount) * rate;\r\n\r\n      if (possibleFee <= remaining) {\r\n        fee = possibleFee;\r\n        this.setData({ collectedWaterFee: this.data.collectedWaterFee + fee });\r\n        actualAmount = amount > 0 ? amount - fee : amount + fee;\r\n      } else {\r\n        fee = remaining;\r\n        this.setData({ collectedWaterFee: target });\r\n        actualAmount = amount > 0 ? amount - fee : amount + fee;\r\n      }\r\n      this.log(`ä» ${fromMember.name} æŠ½å– ${fee.toFixed(2)} å…ƒæ°´è´¹ï¼ˆå½“å‰ï¼š${this.data.collectedWaterFee.toFixed(2)}ï¼‰`);\r\n    } else {\r\n      this.log(\"å·²è¾¾æ°´è´¹ä¸Šé™ï¼Œåœæ­¢æŠ½æˆ\");\r\n    }\r\n\r\n    fromMember.balance -= amount;\r\n    toMember.balance += actualAmount;\r\n\r\n    const timestamp = new Date().toLocaleString();\r\n    fromMember.history.push({ type: 'out', amount, to: toName, fee, timestamp });\r\n    toMember.history.push({ type: 'in', amount: actualAmount, from: fromMember.name, timestamp });\r\n    fromMember.undoDisabled = false;\r\n\r\n    this.setData({ members: this.data.members });\r\n    this.log(`${fromMember.name} ç»™ ${toName} è½¬è´¦ï¼š${amount} å…ƒï¼ˆå®é™…åˆ°è´¦ï¼š${actualAmount.toFixed(2)} å…ƒï¼‰`);\r\n    this.saveDataToLocalStorage();\r\n\r\n    this.closeModal();\r\n  },\r\n  closeModal() {\r\n    this.setData({ showGiveScoreModal: false });\r\n  },\r\n\r\n  showHistory(e) {\r\n    const id = e.currentTarget.dataset.id;\r\n    const member = this.data.members.find(m => m.id === id);\r\n    if (!member || member.history.length === 0) {\r\n      wx.showToast({ title: 'æš‚æ— è®°å½•' });\r\n      return;\r\n    }\r\n\r\n    const historyList = member.history.map(h => {\r\n      if (h.type === 'in') {\r\n        return `${h.timestamp} æ”¶åˆ° ${h.from} è½¬è´¦ï¼š${h.amount.toFixed(2)} å…ƒ`;\r\n      } else {\r\n        return `${h.timestamp} è½¬å‡ºç»™ ${h.to}ï¼š${h.amount.toFixed(2)} å…ƒï¼ˆæŠ½æˆï¼š${h.fee.toFixed(2)} å…ƒï¼‰`;\r\n      }\r\n    }).join('\\n');\r\n\r\n    this.setData({\r\n      showHistoryModal: true,\r\n      historyMemberName: member.name,\r\n      historyText: historyList\r\n    });\r\n  },\r\n  closeHistoryModal() {\r\n    this.setData({ showHistoryModal: false });\r\n  },\r\n\r\n  hasUnReversedOut(member) {\r\n    return member.history.some(h => h.type === 'out') && !member.undoDisabled;\r\n  },\r\n\r\n  startTable() {\r\n    if (this.data.members.length === 0) {\r\n      wx.showToast({ title: 'è‡³å°‘éœ€è¦æ·»åŠ ä¸€åæˆå‘˜æ‰èƒ½å¼€å°' });\r\n      return;\r\n    }\r\n\r\n    const hourlyRate = this.data.hourlyRate;\r\n    if (hourlyRate <= 0) {\r\n      wx.showToast({ title: 'è¯·è¾“å…¥æ­£ç¡®çš„æ¯å°æ—¶è´¹ç”¨ï¼' });\r\n      return;\r\n    }\r\n\r\n    const mode = this.data.endMode;\r\n    const now = new Date().getTime();\r\n\r\n    let scheduledEndTime = null;\r\n    if (mode === 'time') {\r\n      const timeStr = this.data.endTime;\r\n      if (!timeStr) {\r\n        wx.showToast({ title: 'è¯·é€‰æ‹©ä¸€ä¸ªæœªæ¥æ—¶é—´' });\r\n        return;\r\n      }\r\n      scheduledEndTime = new Date(timeStr).getTime();\r\n      if (scheduledEndTime <= now) {\r\n        wx.showToast({ title: 'è®¾å®šçš„æ—¶é—´ä¸èƒ½æ—©äºå½“å‰æ—¶é—´' });\r\n        return;\r\n      }\r\n      setTimeout(() => {\r\n        this.endTable();\r\n      }, scheduledEndTime - now);\r\n    } else if (mode === 'duration') {\r\n      const minutes = parseInt(this.data.duration);\r\n      if (isNaN(minutes) || minutes <= 0) {\r\n        wx.showToast({ title: 'è¯·è¾“å…¥æœ‰æ•ˆçš„åˆ†é’Ÿæ•°' });\r\n        return;\r\n      }\r\n      scheduledEndTime = now + minutes * 60 * 1000;\r\n      setTimeout(() => {\r\n        this.endTable();\r\n      }, minutes * 60 * 1000);\r\n    }\r\n\r\n    const startTime = now;\r\n    this.setData({\r\n      startTime: startTime,\r\n      scheduledEndTime: scheduledEndTime,\r\n      collectedWaterFee: 0,\r\n      btnStartDisabled: true,\r\n      btnEndDisabled: false\r\n    });\r\n\r\n    // è®¾ç½®æ‰€æœ‰éåœ¨çº¿æˆå‘˜ä¸ºåœ¨çº¿çŠ¶æ€\r\n    const updatedMembers = this.data.members.map(member => ({\r\n      ...member,\r\n      joinTime: member.active ? member.joinTime : now,\r\n      active: true\r\n    }));\r\n    this.setData({ members: updatedMembers });\r\n\r\n    // å¯åŠ¨è®¡æ—¶å™¨\r\n    this.startTimer(startTime);\r\n\r\n    this.saveDataToLocalStorage();\r\n  },\r\n\r\n  startTimer(startTime) {\r\n    if (this.durationInterval) clearInterval(this.durationInterval);\r\n    this.durationInterval = setInterval(() => {\r\n      const elapsed = new Date().getTime() - startTime;\r\n      this.setData({\r\n        durationDisplay: formatDuration(elapsed)\r\n      });\r\n    }, 1000);\r\n\r\n    if (this.timerInterval) clearInterval(this.timerInterval);\r\n    this.timerInterval = setInterval(() => {\r\n      this.updateCosts();\r\n    }, 1000);\r\n  },\r\n\r\n  endTable() {\r\n    const now = new Date().getTime();\r\n    const updatedMembers = this.data.members.map(member => {\r\n      if (member.active) {\r\n        member.totalTime += now - member.joinTime;\r\n        member.joinTime = null;\r\n        member.active = false;\r\n      }\r\n      return member;\r\n    });\r\n\r\n    // è®¡ç®—æ€»è´¹ç”¨å¹¶ä¿å­˜\r\n    const totalTableCost = this.calculateTotalTableCost(now);\r\n    this.setData({\r\n      totalCost: totalTableCost,\r\n      collectedWaterFee: this.data.collectedWaterFee,\r\n      isEnded: true,\r\n      btnEndDisabled: true,\r\n      btnAddDisabled: true,\r\n      members: updatedMembers\r\n    });\r\n\r\n    wx.setStorageSync('lastTotalCost', totalTableCost);\r\n    wx.setStorageSync('lastWaterFee', this.data.collectedWaterFee);\r\n    wx.setStorageSync('lastTotalDuration', now - this.data.startTime);\r\n\r\n    wx.showToast({ title: `æ€»è´¹ç”¨ï¼š${totalTableCost.toFixed(2)} å…ƒ` });\r\n    this.saveDataToLocalStorage();\r\n    this.updateCosts();\r\n  },\r\n\r\n  calculateTotalTableCost(now) {\r\n    const startTime = this.data.startTime;\r\n    if (!startTime) return 0;\r\n    const hours = (now - startTime) / (1000 * 60 * 60);\r\n    return this.data.hourlyRate * hours;\r\n  },\r\n\r\n  updateCosts() {\r\n    const now = new Date().getTime();\r\n    const isEnded = this.data.isEnded;\r\n    const totalTableCost = isEnded\r\n        ? wx.getStorageSync('lastTotalCost') || 0\r\n        : this.calculateTotalTableCost(now);\r\n\r\n    const updatedMembers = this.data.members.map(member => {\r\n      if (isEnded) {\r\n        member.costText = member.finalBalance?.toFixed(2) || '0.00';\r\n      } else {\r\n        const totalActiveTime = this.data.members.reduce((acc, m) => {\r\n          const session = m.active ? (now - m.joinTime) : 0;\r\n          return acc + m.totalTime + session;\r\n        }, 0);\r\n\r\n        if (totalActiveTime === 0) {\r\n          member.costText = '0.00';\r\n        } else {\r\n          const memberTime = member.totalTime + (member.active ? (now - member.joinTime) : 0);\r\n          const cost = (memberTime / totalActiveTime) * totalTableCost;\r\n          member.costText = cost.toFixed(2);\r\n        }\r\n      }\r\n      return member;\r\n    });\r\n\r\n    this.setData({\r\n      members: updatedMembers,\r\n      totalCost: totalTableCost\r\n    });\r\n  },\r\n\r\n  resetAll() {\r\n    if (wx.showModal({\r\n      title: 'ç¡®è®¤é‡ç½®',\r\n      content: 'ç¡®å®šè¦é‡ç½®æ‰€æœ‰æ•°æ®å—ï¼Ÿ',\r\n      success: res => {\r\n        if (res.confirm) {\r\n          this.setData({\r\n            hourlyRate: 0,\r\n            waterFeeRate: 50,\r\n            waterFeeTarget: 50,\r\n            collectedWaterFee: 0,\r\n            endMode: 'manual',\r\n            endModeText: 'æ‰‹åŠ¨å…³å°',\r\n            endTime: '',\r\n            duration: '',\r\n            members: [],\r\n            isEnded: false,\r\n            btnStartDisabled: true,\r\n            btnEndDisabled: true,\r\n            durationDisplay: '00:00:00',\r\n            totalCost: 0,\r\n            logContent: ''\r\n          });\r\n\r\n          if (this.timerInterval) clearInterval(this.timerInterval);\r\n          if (this.durationInterval) clearInterval(this.durationInterval);\r\n\r\n          this.saveDataToLocalStorage();\r\n          this.clearLocalStorageData();\r\n        }\r\n      }\r\n    }));\r\n  },\r\n\r\n  undoLastTransfer(e) {\r\n    const id = e.currentTarget.dataset.id;\r\n    const member = this.data.members.find(m => m.id === id);\r\n    if (!member || !member.history.length) return;\r\n\r\n    if (member.undoDisabled) {\r\n      wx.showToast({ title: 'æ¯æ¬¡åªèƒ½æ’¤å›ä¸€æ¬¡ï¼Œè½¬è´¦åå¯å†æ¬¡æ“ä½œ' });\r\n      return;\r\n    }\r\n\r\n    const lastOutIndex = member.history.findIndex(h => h.type === 'out');\r\n    if (lastOutIndex === -1) {\r\n      wx.showToast({ title: 'æ— å¯æ’¤å›çš„è½¬è´¦' });\r\n      return;\r\n    }\r\n\r\n    const lastTransfer = member.history[lastOutIndex];\r\n    const { amount, fee, to } = lastTransfer;\r\n    const toMember = this.data.members.find(m => m.name === to);\r\n\r\n    // æ’¤å›æ“ä½œ\r\n    member.balance += amount;\r\n    if (toMember) {\r\n      toMember.balance -= (amount - fee);\r\n      const index = toMember.history.findIndex(h => h.from === member.name && h.amount === (amount - fee));\r\n      if (index !== -1) {\r\n        toMember.history.splice(index, 1);\r\n      }\r\n    }\r\n\r\n    this.setData({ collectedWaterFee: this.data.collectedWaterFee - fee });\r\n    member.history.splice(lastOutIndex, 1);\r\n    member.undoDisabled = true;\r\n\r\n    this.setData({ members: this.data.members });\r\n    this.saveDataToLocalStorage();\r\n  },\r\n\r\n  saveDataToLocalStorage() {\r\n    const data = {\r\n      hourlyRate: this.data.hourlyRate,\r\n      waterFeeRate: this.data.waterFeeRate,\r\n      waterFeeTarget: this.data.waterFeeTarget,\r\n      collectedWaterFee: this.data.collectedWaterFee,\r\n      endMode: this.data.endMode,\r\n      endTime: this.data.endTime,\r\n      duration: this.data.duration,\r\n      members: this.data.members.map(m => ({\r\n        ...m,\r\n        undoDisabled: !!m.undoDisabled,\r\n        finalBalance: m.finalBalance ?? 0\r\n      })),\r\n      logContent: this.data.logContent,\r\n      isEnded: this.data.isEnded\r\n    };\r\n    wx.setStorageSync('tableData', data);\r\n  },\r\n\r\n  loadDataFromLocalStorage() {\r\n    const data = wx.getStorageSync('tableData');\r\n    if (data) {\r\n      this.setData({\r\n        hourlyRate: data.hourlyRate,\r\n        waterFeeRate: data.waterFeeRate,\r\n        waterFeeTarget: data.waterFeeTarget,\r\n        collectedWaterFee: data.collectedWaterFee,\r\n        endMode: data.endMode,\r\n        endTime: data.endTime,\r\n        duration: data.duration,\r\n        members: data.members || [],\r\n        logContent: data.logContent || '',\r\n        isEnded: data.isEnded || false\r\n      });\r\n\r\n      if (data.isEnded) {\r\n        const duration = wx.getStorageSync('lastTotalDuration');\r\n        this.setData({\r\n          durationDisplay: duration ? formatDuration(duration) : '00:00:00'\r\n        });\r\n      }\r\n\r\n      this.updateButtonStates();\r\n    }\r\n  },\r\n\r\n  updateButtonStates() {\r\n    const isStarted = !!this.data.startTime;\r\n    const isEnded = this.data.isEnded;\r\n    this.setData({\r\n      btnStartDisabled: this.data.members.length === 0 || isStarted || isEnded,\r\n      btnEndDisabled: !isStarted || isEnded,\r\n      btnAddDisabled: isEnded\r\n    });\r\n  },\r\n\r\n  clearLocalStorageData() {\r\n    wx.removeStorageSync('tableData');\r\n    wx.removeStorageSync('lastTotalCost');\r\n    wx.removeStorageSync('lastWaterFee');\r\n    wx.removeStorageSync('lastTotalDuration');\r\n  },\r\n\r\n  log(msg) {\r\n    const time = new Date().toLocaleTimeString();\r\n    const content = `[${time}] ${msg}\\n` + this.data.logContent;\r\n    this.setData({ logContent: content });\r\n  }\r\n});
===================================================================
diff --git a/xiaochengxu/pages/index/index.js b/xiaochengxu/pages/index/index.js
--- a/xiaochengxu/pages/index/index.js	
+++ b/xiaochengxu/pages/index/index.js	
@@ -86,8 +86,8 @@
         name: name,
         joinTime: this.data.startTime ? new Date().getTime() : null,
         totalTime: 0,
-        balance: 0,
-        finalBalance: 0,
+        point: 0,
+        finalPoint: 0,
         active: this.data.startTime ? true : false,
         history: [],
         undoDisabled: false
@@ -202,8 +202,8 @@
       this.log("å·²è¾¾æ°´è´¹ä¸Šé™ï¼Œåœæ­¢æŠ½æˆ");
     }
 
-    fromMember.balance -= amount;
-    toMember.balance += actualAmount;
+    fromMember.point -= amount;
+    toMember.point += actualAmount;
 
     const timestamp = new Date().toLocaleString();
     fromMember.history.push({ type: 'out', amount, to: toName, fee, timestamp });
@@ -377,7 +377,7 @@
 
     const updatedMembers = this.data.members.map(member => {
       if (isEnded) {
-        member.costText = member.finalBalance?.toFixed(2) || '0.00';
+        member.costText = member.finalPoint?.toFixed(2) || '0.00';
       } else {
         const totalActiveTime = this.data.members.reduce((acc, m) => {
           const session = m.active ? (now - m.joinTime) : 0;
@@ -456,9 +456,9 @@
     const toMember = this.data.members.find(m => m.name === to);
 
     // æ’¤å›æ“ä½œ
-    member.balance += amount;
+    member.point += amount;
     if (toMember) {
-      toMember.balance -= (amount - fee);
+      toMember.point -= (amount - fee);
       const index = toMember.history.findIndex(h => h.from === member.name && h.amount === (amount - fee));
       if (index !== -1) {
         toMember.history.splice(index, 1);
@@ -485,7 +485,7 @@
       members: this.data.members.map(m => ({
         ...m,
         undoDisabled: !!m.undoDisabled,
-        finalBalance: m.finalBalance ?? 0
+        finalPoint: m.finalPoint ?? 0
       })),
       logContent: this.data.logContent,
       isEnded: this.data.isEnded
Index: xiaochengxu/pages/index/index.wxml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><view class=\"container\">\r\n  <text class=\"title\">\uD83C\uDFB1 å°çƒåˆ†æ‘Š&è®¡åˆ†</text>\r\n\r\n  <view class=\"form-group\">\r\n    <text>æ¯å°æ—¶è´¹ç”¨ï¼ˆå…ƒï¼‰ï¼š</text>\r\n    <input type=\"digit\" bindinput=\"onHourlyRateInput\" placeholder=\"ä¾‹å¦‚ï¼š30\"/>\r\n  </view>\r\n\r\n  <view class=\"form-group\">\r\n    <text>é€‰æ‹©å…³å°æ–¹å¼ï¼š</text>\r\n    <picker mode=\"selector\" range=\"{{['æ‰‹åŠ¨å…³å°', 'æŒ‡å®šæ—¶é—´å…³å°ï¼ˆå‹¿å…³ï¼‰', 'æ—¶é•¿å…³å°ï¼ˆå‹¿å…³ï¼‰']}}\" bindchange=\"toggleEndOptions\"></picker>\r\n  </view>\r\n\r\n  <block wx:if=\"{{timeOptionVisible}}\">\r\n    <view class=\"form-group\">\r\n      <text>è¯·è¾“å…¥å…³å°æ—¶é—´ï¼š</text>\r\n      <input type=\"time\" bindinput=\"onEndTimeInput\"/>\r\n    </view>\r\n  </block>\r\n\r\n  <block wx:if=\"{{durationOptionVisible}}\">\r\n    <view class=\"form-group\">\r\n      <text>å¤šå°‘åˆ†é’Ÿåå…³å°ï¼š</text>\r\n      <input type=\"digit\" bindinput=\"onDurationInput\" placeholder=\"ä¾‹å¦‚ï¼š60\"/>\r\n    </view>\r\n  </block>\r\n\r\n  <view class=\"form-group\">\r\n    <text>æŠ½æˆæ¯”ä¾‹ï¼ˆ%ï¼‰ï¼š</text>\r\n    <input type=\"digit\" bindinput=\"onWaterFeeRateInput\" value=\"{{waterFeeRate}}\"/>\r\n  </view>\r\n\r\n  <view class=\"form-group\">\r\n    <text>æ°´è´¹ç›®æ ‡é‡‘é¢ï¼ˆå…ƒï¼‰ï¼š</text>\r\n    <input type=\"digit\" bindinput=\"onWaterFeeTargetInput\" value=\"{{waterFeeTarget}}\"/>\r\n  </view>\r\n\r\n  <view class=\"result\">\r\n    <text>â²ï¸ å·²å¼€å°æ—¶é—´ï¼š{{durationDisplay}}</text>\r\n  </view>\r\n\r\n  <view class=\"result\">\r\n    <text>\uD83D\uDCB3 å½“å‰æ€»è´¹ç”¨ï¼š{{totalCost.toFixed(2)}} å…ƒ</text>\r\n    <text>\uD83E\uDED6 å½“å‰æ°´è´¹ï¼š{{collectedWaterFee.toFixed(2)}} å…ƒ</text>\r\n  </view>\r\n\r\n  <button class=\"btn-add\" bindtap=\"addPerson\">\uD83D\uDE4B\u200Dâ™‚ æ·»åŠ æˆå‘˜</button>\r\n\r\n  <block wx:for=\"{{members}}\" wx:key=\"id\">\r\n    <view class=\"person-card\">\r\n      <text>{{item.name}} {{item.active ? '(åœ¨çº¿)' : '(ç¦»çº¿)'}}</text>\r\n      <text>\uD83D\uDCB0 ä½™é¢ï¼š{{item.balance.toFixed(2)}} å…ƒ</text>\r\n      <text>\uD83D\uDCB8 åˆ†æ‘Šè´¹ç”¨ï¼š{{item.costText}}</text>\r\n      <view class=\"actions\">\r\n        <button wx:if=\"{{item.active}}\" bindtap=\"leaveMember\" data-id=\"{{item.id}}\">âŒ é€€å‡º</button>\r\n        <button wx:if=\"{{!item.active}}\" bindtap=\"rejoinMember\" data-id=\"{{item.id}}\">âœ… åŠ å…¥</button>\r\n        <button bindtap=\"openGiveScoreModal\" data-id=\"{{item.id}}\">\uD83D\uDCB8 è½¬è´¦</button>\r\n        <button wx:if=\"{{item.history.length > 0}}\" bindtap=\"showHistory\" data-id=\"{{item.id}}\">\uD83D\uDCDC è®°å½•</button>\r\n        <button wx:if=\"{{hasUnReversedOut(item)}}\" class=\"undo-btn\" bindtap=\"undoLastTransfer\" data-id=\"{{item.id}}\">â†©ï¸ æ’¤å›</button>\r\n      </view>\r\n    </view>\r\n  </block>\r\n\r\n  <button class=\"btn-start\" bindtap=\"startTable\" disabled=\"{{btnStartDisabled}}\">\uD83D\uDD25 å¼€å°</button>\r\n  <button class=\"btn-end\" bindtap=\"endTable\" disabled=\"{{btnEndDisabled}}\">â›” å…³å°</button>\r\n  <button class=\"btn-reset\" bindtap=\"resetAll\">â™»ï¸ é‡ç½®</button>\r\n\r\n  <text class=\"log-title\">æ“ä½œæ˜ç»†æ—¥å¿—</text>\r\n  <scroll-view scroll-y class=\"log\">{{logContent}}</scroll-view>\r\n</view>
===================================================================
diff --git a/xiaochengxu/pages/index/index.wxml b/xiaochengxu/pages/index/index.wxml
--- a/xiaochengxu/pages/index/index.wxml	
+++ b/xiaochengxu/pages/index/index.wxml	
@@ -31,7 +31,7 @@
   </view>
 
   <view class="form-group">
-    <text>æ°´è´¹ç›®æ ‡é‡‘é¢ï¼ˆå…ƒï¼‰ï¼š</text>
+    <text>æ°´è´¹ç›®æ ‡ç§¯åˆ†ï¼š</text>
     <input type="digit" bindinput="onWaterFeeTargetInput" value="{{waterFeeTarget}}"/>
   </view>
 
@@ -49,7 +49,7 @@
   <block wx:for="{{members}}" wx:key="id">
     <view class="person-card">
       <text>{{item.name}} {{item.active ? '(åœ¨çº¿)' : '(ç¦»çº¿)'}}</text>
-      <text>ğŸ’° ä½™é¢ï¼š{{item.balance.toFixed(2)}} å…ƒ</text>
+      <text>ğŸ’° ç§¯åˆ†ï¼š{{item.point.toFixed(2)}} å…ƒ</text>
       <text>ğŸ’¸ åˆ†æ‘Šè´¹ç”¨ï¼š{{item.costText}}</text>
       <view class="actions">
         <button wx:if="{{item.active}}" bindtap="leaveMember" data-id="{{item.id}}">âŒ é€€å‡º</button>
Index: xiaochengxu/pages/index/index.wxss
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>page {\r\n  background-color: #f4f6f9;\r\n}\r\n\r\n.container {\r\n  max-width: 500px;\r\n  margin: auto;\r\n  padding: 20rpx;\r\n}\r\n\r\n.btn-add,\r\n.btn-start,\r\n.btn-end,\r\n.btn-reset {\r\n  margin-top: 10rpx;\r\n  width: 100%;\r\n  font-size: 32rpx;\r\n  border-radius: 8rpx;\r\n  padding: 20rpx;\r\n}\r\n\r\n.btn-add {\r\n  background-color: #007bff;\r\n  color: white;\r\n}\r\n\r\n.btn-start {\r\n  background-color: #28a745;\r\n  color: white;\r\n}\r\n\r\n.btn-end {\r\n  background-color: #dc3545;\r\n  color: white;\r\n}\r\n\r\n.btn-reset {\r\n  background-color: #ffc107;\r\n  color: black;\r\n}\r\n\r\n.name {\r\n  font-weight: bold;\r\n}\r\n\r\n.status {\r\n  font-size: 24rpx;\r\n  color: green;\r\n}\r\n\r\n.balance {\r\n  font-weight: bold;\r\n  color: #dc3545;\r\n  font-size: 28rpx;\r\n  margin-top: 8rpx;\r\n}\r\n\r\n.cost {\r\n  font-weight: bold;\r\n  min-width: 60px;\r\n  text-align: right;\r\n  font-size: 28rpx;\r\n  color: #28a745;\r\n}\r\n\r\n.actions {\r\n  display: flex;\r\n  flex-wrap: wrap;\r\n  gap: 12rpx;\r\n  margin-top: 16rpx;\r\n}\r\n\r\n.actions button {\r\n  flex: 1 1 calc(50% - 6px);\r\n  max-width: calc(50% - 6px);\r\n  padding: 12rpx 20rpx;\r\n  font-size: 26rpx;\r\n  min-height: 80rpx;\r\n  box-sizing: border-box;\r\n  background: linear-gradient(145deg, #ffffff, #f0f0f0);\r\n  border: 1rpx solid #ddd;\r\n  box-shadow: 0 2rpx 8rpx rgba(0, 0, 0, 0.1);\r\n  transition: all 0.2s ease-in-out;\r\n}\r\n\r\n.actions .undo-btn {\r\n  background: linear-gradient(145deg, #e34848, #d50909);\r\n  color: white;\r\n  border-color: #da3838;\r\n}\r\n\r\n.modal-overlay {\r\n  position: fixed;\r\n  top: 0;\r\n  left: 0;\r\n  width: 100%;\r\n  height: 100%;\r\n  background: rgba(0, 0, 0, 0.5);\r\n  z-index: 1000;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n}\r\n\r\n.modal {\r\n  background: white;\r\n  padding: 40rpx;\r\n  border-radius: 16rpx;\r\n  width: 90%;\r\n  max-width: 400px;\r\n  box-shadow: 0 10rpx 30rpx rgba(0, 0, 0, 0.2);\r\n}\r\n\r\n.history-modal {\r\n  max-height: 400rpx;\r\n  overflow-y: auto;\r\n}\r\n\r\n.undo-btn {\r\n  background-color: #6c757d;\r\n  color: white;\r\n  font-size: 28rpx;\r\n}\r\n\r\n.log {\r\n  margin-top: 30rpx;\r\n  white-space: pre-wrap;\r\n  background-color: #f8f9fa;\r\n  padding: 20rpx;\r\n  border-radius: 12rpx;\r\n  height: 200rpx;\r\n  overflow-y: auto;\r\n  font-size: 24rpx;\r\n  color: #555;\r\n}\r\n\r\n.result {\r\n  margin-top: 30rpx;\r\n  font-size: 32rpx;\r\n  font-weight: bold;\r\n  text-align: center;\r\n  color: #333;\r\n}
===================================================================
diff --git a/xiaochengxu/pages/index/index.wxss b/xiaochengxu/pages/index/index.wxss
--- a/xiaochengxu/pages/index/index.wxss	
+++ b/xiaochengxu/pages/index/index.wxss	
@@ -48,7 +48,7 @@
   color: green;
 }
 
-.balance {
+.point {
   font-weight: bold;
   color: #dc3545;
   font-size: 28rpx;
